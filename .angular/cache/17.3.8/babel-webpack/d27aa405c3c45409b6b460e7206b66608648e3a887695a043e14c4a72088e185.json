{"ast":null,"code":"import _asyncToGenerator from \"C:/project_mengkerent/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { HttpHeaders } from '@angular/common/http';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/common/http\";\nimport * as i3 from \"@ionic/storage-angular\";\nimport * as i4 from \"@ionic/angular\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/forms\";\nfunction PemesananPage_ion_item_27_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-item\");\n    i0.ɵɵelement(1, \"ion-icon\", 29);\n    i0.ɵɵelementStart(2, \"ion-label\");\n    i0.ɵɵtext(3, \"Durasi Penyewaan (hari)\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 30)(5, \"ion-button\", 31);\n    i0.ɵɵlistener(\"click\", function PemesananPage_ion_item_27_Template_ion_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.increment());\n    });\n    i0.ɵɵtext(6, \"+\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"ion-input\", 32);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function PemesananPage_ion_item_27_Template_ion_input_ngModelChange_7_listener($event) {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r1.number, $event) || (ctx_r1.number = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"ion-button\", 33);\n    i0.ɵɵlistener(\"click\", function PemesananPage_ion_item_27_Template_ion_button_click_8_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.decrement());\n    });\n    i0.ɵɵtext(9, \"-\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(7);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r1.number);\n  }\n}\nfunction PemesananPage_ion_card_40_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-card\", 34)(1, \"ion-card-header\")(2, \"ion-card-subtitle\");\n    i0.ɵɵtext(3, \"Alamat :\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"ion-card-content\")(5, \"ion-textarea\", 35);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function PemesananPage_ion_card_40_Template_ion_textarea_ngModelChange_5_listener($event) {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r1.alamat, $event) || (ctx_r1.alamat = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r1.alamat);\n  }\n}\nexport let PemesananPage = /*#__PURE__*/(() => {\n  var _PemesananPage;\n  class PemesananPage {\n    constructor(router, http, storage, alertController) {\n      this.router = router;\n      this.http = http;\n      this.storage = storage;\n      this.alertController = alertController;\n      this.selectedDuration = '';\n      this.selectedService = 'antar'; // Default value\n      this.alamat = '';\n      this.number = 1; // Default value for custom duration\n      this.initStorage();\n    }\n    initStorage() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        yield _this.storage.create();\n      })();\n    }\n    ngOnInit() {\n      const carData = localStorage.getItem('selectedCar');\n      if (carData) {\n        this.car = JSON.parse(carData);\n      } else {\n        console.error('Car data is not found in localStorage');\n        // Handle case where car data is not found (optional)\n      }\n    }\n    durationChanged() {\n      console.log('Selected duration:', this.selectedDuration);\n    }\n    serviceChanged() {\n      console.log('Selected service:', this.selectedService);\n    }\n    increment() {\n      this.number++;\n    }\n    decrement() {\n      if (this.number > 1) {\n        this.number--;\n      }\n    }\n    booking() {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        if (!_this2.car || !_this2.car.id || !_this2.selectedDuration || !_this2.selectedService || _this2.selectedService !== 'self' && !_this2.alamat) {\n          const alert = yield _this2.alertController.create({\n            header: 'Error',\n            message: 'Lengkapi pengisian data.',\n            buttons: ['OK']\n          });\n          yield alert.present();\n          return;\n        }\n        // Pastikan `durasi` dan `pelayanan` dikirim sesuai dengan format yang diharapkan oleh server\n        const orderData = {\n          durasi: _this2.selectedDuration === 'custom' ? `${_this2.number}` : _this2.selectedDuration,\n          pelayanan: _this2.selectedService,\n          alamat: _this2.alamat\n        };\n        // Log the data being sent\n        console.log('Order Data:', orderData);\n        // Ambil token dari storage\n        const token = yield _this2.storage.get('auth-token');\n        if (!token) {\n          const alert = yield _this2.alertController.create({\n            header: 'Error',\n            message: 'No authentication token found.',\n            buttons: ['OK']\n          });\n          yield alert.present();\n          return;\n        }\n        // Set header dengan token dan Content-Type\n        const headers = new HttpHeaders({\n          'Authorization': `Bearer ${token}`,\n          'Content-Type': 'application/json' // Ensure content type is JSON\n        });\n        // Kirim permintaan POST ke API\n        _this2.http.post(`https://www.sipelantis.com/api/orders/${_this2.car.id}`, orderData, {\n          headers\n        }).subscribe( /*#__PURE__*/function () {\n          var _ref = _asyncToGenerator(function* (response) {\n            console.log('Order successful:', response);\n            const alert = yield _this2.alertController.create({\n              header: 'Success',\n              message: 'Pemesanan berhasil.',\n              buttons: ['OK']\n            });\n            yield alert.present();\n            // Handle successful order (e.g., navigate to a confirmation page)\n            _this2.router.navigate(['/transaksi']);\n          });\n          return function (_x) {\n            return _ref.apply(this, arguments);\n          };\n        }(), /*#__PURE__*/function () {\n          var _ref2 = _asyncToGenerator(function* (error) {\n            console.error('Error creating order:', error);\n            const alert = yield _this2.alertController.create({\n              header: 'Error',\n              message: 'Error creating order. Please try again.',\n              buttons: ['OK']\n            });\n            yield alert.present();\n          });\n          return function (_x2) {\n            return _ref2.apply(this, arguments);\n          };\n        }());\n      })();\n    }\n    home() {\n      this.router.navigate(['/home']);\n    }\n    order() {\n      this.router.navigate(['/cars']);\n    }\n    transaksi() {\n      this.router.navigate(['/transaksi']);\n    }\n    profile() {\n      this.router.navigate(['/profile']);\n    }\n  }\n  _PemesananPage = PemesananPage;\n  _PemesananPage.ɵfac = function PemesananPage_Factory(t) {\n    return new (t || _PemesananPage)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.HttpClient), i0.ɵɵdirectiveInject(i3.Storage), i0.ɵɵdirectiveInject(i4.AlertController));\n  };\n  _PemesananPage.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: _PemesananPage,\n    selectors: [[\"app-pemesanan\"]],\n    decls: 58,\n    vars: 7,\n    consts: [[1, \"ion-text-center\", \"content-center\"], [\"id\", \"container\"], [1, \"boy\"], [1, \"car-card\"], [1, \"name-car\"], [\"alt\", \"Deskripsi gambar\", 3, \"src\"], [1, \"spek\"], [\"name\", \"car-outline\", \"slot\", \"start\"], [\"aria-label\", \"Durasi\", \"interface\", \"action-sheet\", \"placeholder\", \"Durasi\", 3, \"ngModelChange\", \"ionChange\", \"ngModel\"], [\"value\", \"6jam\"], [\"value\", \"12jam\"], [\"value\", \"24jam\"], [\"value\", \"custom\"], [4, \"ngIf\"], [3, \"ngModelChange\", \"ionChange\", \"allowEmptySelection\", \"ngModel\"], [\"slot\", \"end\", \"value\", \"driver\"], [\"slot\", \"end\", \"value\", \"antar\"], [\"color\", \"light\", 4, \"ngIf\"], [\"expand\", \"block\", 3, \"click\"], [\"id\", \"tabs\"], [\"slot\", \"bottom\"], [\"id\", \"home\", \"tab\", \"home\", 3, \"click\"], [\"name\", \"home-outline\"], [\"tab\", \"radio\", 3, \"click\"], [\"name\", \"car-outline\"], [\"tab\", \"transaksi\", 3, \"click\"], [\"name\", \"cash-outline\"], [\"tab\", \"library\", 3, \"click\"], [\"name\", \"person-outline\"], [\"name\", \"calendar-outline\", \"slot\", \"start\"], [1, \"number-input\"], [\"color\", \"black\", 1, \"plus\", 3, \"click\"], [\"type\", \"number\", \"readonly\", \"\", 3, \"ngModelChange\", \"ngModel\"], [\"color\", \"black\", 1, \"minus\", 3, \"click\"], [\"color\", \"light\"], [\"placeholder\", \"Masukan alamat rumah\", 3, \"ngModelChange\", \"ngModel\"]],\n    template: function PemesananPage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-content\", 0)(1, \"div\", 1)(2, \"ion-card\")(3, \"p\");\n        i0.ɵɵtext(4, \"Atur Penyewaan\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(5, \"br\");\n        i0.ɵɵelementStart(6, \"ion-card\", 2)(7, \"ion-card-content\")(8, \"div\", 3)(9, \"div\", 4);\n        i0.ɵɵelement(10, \"img\", 5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"div\", 6)(12, \"h1\");\n        i0.ɵɵtext(13);\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵelementStart(14, \"ion-item\");\n        i0.ɵɵelement(15, \"ion-icon\", 7);\n        i0.ɵɵelementStart(16, \"ion-label\");\n        i0.ɵɵtext(17, \"Durasi Peminjaman\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"ion-select\", 8);\n        i0.ɵɵtwoWayListener(\"ngModelChange\", function PemesananPage_Template_ion_select_ngModelChange_18_listener($event) {\n          i0.ɵɵtwoWayBindingSet(ctx.selectedDuration, $event) || (ctx.selectedDuration = $event);\n          return $event;\n        });\n        i0.ɵɵlistener(\"ionChange\", function PemesananPage_Template_ion_select_ionChange_18_listener() {\n          return ctx.durationChanged();\n        });\n        i0.ɵɵelementStart(19, \"ion-select-option\", 9);\n        i0.ɵɵtext(20, \"6 Jam\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(21, \"ion-select-option\", 10);\n        i0.ɵɵtext(22, \"12 Jam\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(23, \"ion-select-option\", 11);\n        i0.ɵɵtext(24, \"24 Jam\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"ion-select-option\", 12);\n        i0.ɵɵtext(26, \"1 hari+\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵtemplate(27, PemesananPage_ion_item_27_Template, 10, 1, \"ion-item\", 13);\n        i0.ɵɵelementStart(28, \"ion-item\");\n        i0.ɵɵelement(29, \"ion-icon\", 7);\n        i0.ɵɵelementStart(30, \"ion-radio-group\", 14);\n        i0.ɵɵtwoWayListener(\"ngModelChange\", function PemesananPage_Template_ion_radio_group_ngModelChange_30_listener($event) {\n          i0.ɵɵtwoWayBindingSet(ctx.selectedService, $event) || (ctx.selectedService = $event);\n          return $event;\n        });\n        i0.ɵɵlistener(\"ionChange\", function PemesananPage_Template_ion_radio_group_ionChange_30_listener() {\n          return ctx.serviceChanged();\n        });\n        i0.ɵɵelementStart(31, \"ion-list\")(32, \"ion-item\")(33, \"ion-label\");\n        i0.ɵɵtext(34, \"Pakai Driver?\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(35, \"ion-radio\", 15);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(36, \"ion-item\")(37, \"ion-label\");\n        i0.ɵɵtext(38, \"Di Antar Ke Rumah?\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(39, \"ion-radio\", 16);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵtemplate(40, PemesananPage_ion_card_40_Template, 6, 1, \"ion-card\", 17);\n        i0.ɵɵelementStart(41, \"ion-row\")(42, \"ion-button\", 18);\n        i0.ɵɵlistener(\"click\", function PemesananPage_Template_ion_button_click_42_listener() {\n          return ctx.booking();\n        });\n        i0.ɵɵtext(43, \"Next\");\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵelementStart(44, \"div\", 19)(45, \"ion-tab-bar\", 20)(46, \"ion-tab-button\", 21);\n        i0.ɵɵlistener(\"click\", function PemesananPage_Template_ion_tab_button_click_46_listener() {\n          return ctx.home();\n        });\n        i0.ɵɵelement(47, \"ion-icon\", 22);\n        i0.ɵɵtext(48, \" Home \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(49, \"ion-tab-button\", 23);\n        i0.ɵɵlistener(\"click\", function PemesananPage_Template_ion_tab_button_click_49_listener() {\n          return ctx.order();\n        });\n        i0.ɵɵelement(50, \"ion-icon\", 24);\n        i0.ɵɵtext(51, \" Order \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(52, \"ion-tab-button\", 25);\n        i0.ɵɵlistener(\"click\", function PemesananPage_Template_ion_tab_button_click_52_listener() {\n          return ctx.transaksi();\n        });\n        i0.ɵɵelement(53, \"ion-icon\", 26);\n        i0.ɵɵtext(54, \" Transaksi \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(55, \"ion-tab-button\", 27);\n        i0.ɵɵlistener(\"click\", function PemesananPage_Template_ion_tab_button_click_55_listener() {\n          return ctx.profile();\n        });\n        i0.ɵɵelement(56, \"ion-icon\", 28);\n        i0.ɵɵtext(57, \" Profile \");\n        i0.ɵɵelementEnd()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(10);\n        i0.ɵɵproperty(\"src\", \"https://www.sipelantis.com/images/\" + (ctx.car == null ? null : ctx.car.car_photo), i0.ɵɵsanitizeUrl);\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(ctx.car == null ? null : ctx.car.nama_mobil);\n        i0.ɵɵadvance(5);\n        i0.ɵɵtwoWayProperty(\"ngModel\", ctx.selectedDuration);\n        i0.ɵɵadvance(9);\n        i0.ɵɵproperty(\"ngIf\", ctx.selectedDuration === \"custom\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"allowEmptySelection\", true);\n        i0.ɵɵtwoWayProperty(\"ngModel\", ctx.selectedService);\n        i0.ɵɵadvance(10);\n        i0.ɵɵproperty(\"ngIf\", ctx.selectedService === \"driver\" || ctx.selectedService === \"antar\");\n      }\n    },\n    dependencies: [i5.NgIf, i6.NgControlStatus, i6.NgModel, i4.IonButton, i4.IonCard, i4.IonCardContent, i4.IonCardHeader, i4.IonCardSubtitle, i4.IonContent, i4.IonIcon, i4.IonInput, i4.IonItem, i4.IonLabel, i4.IonList, i4.IonRadio, i4.IonRadioGroup, i4.IonRow, i4.IonSelect, i4.IonSelectOption, i4.IonTabBar, i4.IonTabButton, i4.IonTextarea, i4.NumericValueAccessor, i4.SelectValueAccessor, i4.TextValueAccessor],\n    styles: [\"#container[_ngcontent-%COMP%]{text-align:center;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;position:absolute;left:0;right:0;top:65%;transform:translateY(-50%);padding:10px;background-color:#6c71f7}ion-button[_ngcontent-%COMP%]{height:3rem;margin:5px;color:#fff;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;font-weight:700;width:250px;border-radius:20px;border-style:solid;border-width:2px;align-items:center}ion-row[_ngcontent-%COMP%]{align-items:center;justify-content:center;padding-top:10%;padding-bottom:5%}p[_ngcontent-%COMP%]{margin:0;font-size:1rem;font-style:italic;font-weight:700;line-height:1.5;color:#6c71f7;text-align:center;padding-top:10%}.number-input[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.plus[_ngcontent-%COMP%], .min[_ngcontent-%COMP%]{--padding-start: 0px;--padding-end: 0px;--padding-top: 0px;--padding-bottom: 0px;--border-radius: 50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;font-size:20px}ion-input[_ngcontent-%COMP%]{text-align:center;width:60px}ion-list[_ngcontent-%COMP%]{text-align:center;width:170%}\"]\n  });\n  return PemesananPage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}