{"ast":null,"code":"import _asyncToGenerator from \"C:/project_mengkerent/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { HttpHeaders } from '@angular/common/http';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/common/http\";\nimport * as i3 from \"@ionic/storage-angular\";\nimport * as i4 from \"@ionic/angular\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/forms\";\nfunction TransaksiPage_div_15_ion_card_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-card\")(1, \"ion-card-content\")(2, \"div\", 17)(3, \"div\", 18)(4, \"h1\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\", 19);\n    i0.ɵɵelement(7, \"ion-icon\", 20);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"div\", 21)(10, \"p\");\n    i0.ɵɵelement(11, \"ion-icon\", 22);\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"p\", 23);\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"p\", 23);\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(17, \"ion-button\", 24);\n    i0.ɵɵlistener(\"click\", function TransaksiPage_div_15_ion_card_1_Template_ion_button_click_17_listener() {\n      const transaction_r2 = i0.ɵɵrestoreView(_r1).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.cancelTransaction(transaction_r2.id));\n    });\n    i0.ɵɵtext(18, \" Cancel \");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const transaction_r2 = ctx.$implicit;\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(transaction_r2.nama_mobil);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", transaction_r2.durasi, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", transaction_r2.pelayanan, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(transaction_r2.plat_mobil);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Rp\", transaction_r2.harga, \"\");\n  }\n}\nfunction TransaksiPage_div_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, TransaksiPage_div_15_ion_card_1_Template, 19, 5, \"ion-card\", 16);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.transactions.booking);\n  }\n}\nfunction TransaksiPage_div_16_ion_card_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-card\")(1, \"ion-card-content\")(2, \"div\", 17)(3, \"div\", 18)(4, \"h1\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\", 19);\n    i0.ɵɵelement(7, \"ion-icon\", 20);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"div\", 21)(10, \"p\");\n    i0.ɵɵelement(11, \"ion-icon\", 22);\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"p\", 23);\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"p\", 23);\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd()()()()()();\n  }\n  if (rf & 2) {\n    const transaction_r4 = ctx.$implicit;\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(transaction_r4.nama_mobil);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", transaction_r4.durasi, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", transaction_r4.pelayanan, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(transaction_r4.plat_mobil);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Rp\", transaction_r4.harga, \"/Day\");\n  }\n}\nfunction TransaksiPage_div_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, TransaksiPage_div_16_ion_card_1_Template, 17, 5, \"ion-card\", 16);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.transactions.proses);\n  }\n}\nfunction TransaksiPage_div_17_ion_card_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-card\")(1, \"ion-card-content\")(2, \"div\", 17)(3, \"div\", 18)(4, \"h1\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\", 19);\n    i0.ɵɵelement(7, \"ion-icon\", 20);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"div\", 21)(10, \"p\");\n    i0.ɵɵelement(11, \"ion-icon\", 22);\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"p\", 23);\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"p\", 23);\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"p\", 23);\n    i0.ɵɵtext(18);\n    i0.ɵɵelementEnd()()()()()();\n  }\n  if (rf & 2) {\n    const transaction_r5 = ctx.$implicit;\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(transaction_r5.nama_mobil);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", transaction_r5.durasi, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", transaction_r5.pelayanan, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(transaction_r5.plat_mobil);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Rp\", transaction_r5.harga, \"/Day\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(transaction_r5.status);\n  }\n}\nfunction TransaksiPage_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, TransaksiPage_div_17_ion_card_1_Template, 19, 6, \"ion-card\", 16);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.transactions.selesai);\n  }\n}\nexport let TransaksiPage = /*#__PURE__*/(() => {\n  var _TransaksiPage;\n  class TransaksiPage {\n    constructor(router, http, storage, alertController, toastController) {\n      this.router = router;\n      this.http = http;\n      this.storage = storage;\n      this.alertController = alertController;\n      this.toastController = toastController;\n      this.selectedSegment = 'booking';\n      this.transactions = {\n        booking: [],\n        proses: [],\n        selesai: []\n      };\n      this.initStorage();\n    }\n    initStorage() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        yield _this.storage.create();\n      })();\n    }\n    ngOnInit() {\n      this.loadTransactions();\n    }\n    loadTransactions() {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        const token = yield _this2.storage.get('auth-token');\n        const userId = yield _this2.storage.get('user-id');\n        if (!token) {\n          console.error('No authentication token found');\n          return;\n        }\n        if (!userId) {\n          console.error('No user ID found');\n          return;\n        }\n        const headers = new HttpHeaders({\n          'Authorization': `Bearer ${token}`\n        });\n        _this2.http.get(`https://www.sipelantis.com/api/users/${userId}/transactions`, {\n          headers\n        }).subscribe(response => {\n          _this2.transactions.booking = response.booking;\n          _this2.transactions.proses = response.proses;\n          console.log('Booking Transactions:', _this2.transactions.booking);\n          console.log('Proses Transactions:', _this2.transactions.proses);\n        }, error => {\n          console.error('Error loading transactions:', error);\n        });\n        _this2.http.get(`https://www.sipelantis.com/api/order-history/${userId}`, {\n          headers\n        }).subscribe(response => {\n          _this2.transactions.selesai = response.orderHistories;\n          console.log('Order Histories:', _this2.transactions.selesai);\n        }, error => {\n          console.error('Error loading order histories:', error);\n        });\n      })();\n    }\n    segmentChanged(event) {\n      this.selectedSegment = event.detail.value;\n    }\n    cancelTransaction(transactionId) {\n      var _this3 = this;\n      return _asyncToGenerator(function* () {\n        const alert = yield _this3.alertController.create({\n          header: 'Confirm Cancel',\n          message: 'Are you sure you want to cancel this transaction?',\n          buttons: [{\n            text: 'No',\n            role: 'cancel'\n          }, {\n            text: 'Yes',\n            handler: function () {\n              var _ref = _asyncToGenerator(function* () {\n                const token = yield _this3.storage.get('auth-token');\n                const headers = new HttpHeaders({\n                  'Authorization': `Bearer ${token}`\n                });\n                _this3.http.delete(`https://www.sipelantis.com/api/order/${transactionId}/cancel`, {\n                  headers\n                }).subscribe( /*#__PURE__*/function () {\n                  var _ref2 = _asyncToGenerator(function* (response) {\n                    const toast = yield _this3.toastController.create({\n                      message: 'Transaction cancelled successfully.',\n                      duration: 2000,\n                      color: 'success'\n                    });\n                    toast.present();\n                    _this3.loadTransactions(); // Refresh the transactions list\n                  });\n                  return function (_x) {\n                    return _ref2.apply(this, arguments);\n                  };\n                }(), /*#__PURE__*/function () {\n                  var _ref3 = _asyncToGenerator(function* (error) {\n                    const toast = yield _this3.toastController.create({\n                      message: 'Failed to cancel transaction.',\n                      duration: 2000,\n                      color: 'danger'\n                    });\n                    toast.present();\n                  });\n                  return function (_x2) {\n                    return _ref3.apply(this, arguments);\n                  };\n                }());\n              });\n              return function handler() {\n                return _ref.apply(this, arguments);\n              };\n            }()\n          }]\n        });\n        yield alert.present();\n      })();\n    }\n    home() {\n      this.router.navigate(['/home']);\n    }\n    order() {\n      this.router.navigate(['/cars']);\n    }\n    transaksi() {\n      this.router.navigate(['/transaksi']);\n    }\n    profile() {\n      this.router.navigate(['/profile']);\n    }\n  }\n  _TransaksiPage = TransaksiPage;\n  _TransaksiPage.ɵfac = function TransaksiPage_Factory(t) {\n    return new (t || _TransaksiPage)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.HttpClient), i0.ɵɵdirectiveInject(i3.Storage), i0.ɵɵdirectiveInject(i4.AlertController), i0.ɵɵdirectiveInject(i4.ToastController));\n  };\n  _TransaksiPage.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: _TransaksiPage,\n    selectors: [[\"app-transaksi\"]],\n    decls: 36,\n    vars: 4,\n    consts: [[2, \"background\", \"blue\"], [3, \"ngModelChange\", \"ionChange\", \"ngModel\"], [\"value\", \"booking\"], [\"value\", \"proses\"], [\"value\", \"selesai\"], [4, \"ngIf\"], [\"id\", \"tabs\"], [\"slot\", \"bottom\"], [\"tab\", \"home\", 3, \"click\"], [\"name\", \"home-outline\"], [\"tab\", \"radio\", 3, \"click\"], [\"name\", \"car-outline\"], [\"tab\", \"transaksi\", 3, \"click\"], [\"name\", \"cash-outline\"], [\"tab\", \"library\", 3, \"click\"], [\"name\", \"person-outline\"], [4, \"ngFor\", \"ngForOf\"], [1, \"car-card\"], [1, \"spek\"], [1, \"seats\"], [\"name\", \"bed-outline\"], [1, \"price\"], [\"name\", \"cog-outline\"], [1, \"cash\"], [\"expand\", \"block\", \"color\", \"danger\", 3, \"click\"]],\n    template: function TransaksiPage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-header\", 0)(1, \"ion-toolbar\")(2, \"ion-title\");\n        i0.ɵɵtext(3, \"Transaksi\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(4, \"ion-content\")(5, \"ion-segment\", 1);\n        i0.ɵɵtwoWayListener(\"ngModelChange\", function TransaksiPage_Template_ion_segment_ngModelChange_5_listener($event) {\n          i0.ɵɵtwoWayBindingSet(ctx.selectedSegment, $event) || (ctx.selectedSegment = $event);\n          return $event;\n        });\n        i0.ɵɵlistener(\"ionChange\", function TransaksiPage_Template_ion_segment_ionChange_5_listener($event) {\n          return ctx.segmentChanged($event);\n        });\n        i0.ɵɵelementStart(6, \"ion-segment-button\", 2)(7, \"ion-label\");\n        i0.ɵɵtext(8, \"Booking\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(9, \"ion-segment-button\", 3)(10, \"ion-label\");\n        i0.ɵɵtext(11, \"Proses\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(12, \"ion-segment-button\", 4)(13, \"ion-label\");\n        i0.ɵɵtext(14, \"Selesai\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵtemplate(15, TransaksiPage_div_15_Template, 2, 1, \"div\", 5)(16, TransaksiPage_div_16_Template, 2, 1, \"div\", 5)(17, TransaksiPage_div_17_Template, 2, 1, \"div\", 5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"div\", 6)(19, \"ion-tab-bar\", 7)(20, \"ion-tab-button\", 8);\n        i0.ɵɵlistener(\"click\", function TransaksiPage_Template_ion_tab_button_click_20_listener() {\n          return ctx.home();\n        });\n        i0.ɵɵelement(21, \"ion-icon\", 9);\n        i0.ɵɵelementStart(22, \"ion-label\");\n        i0.ɵɵtext(23, \"Home\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(24, \"ion-tab-button\", 10);\n        i0.ɵɵlistener(\"click\", function TransaksiPage_Template_ion_tab_button_click_24_listener() {\n          return ctx.order();\n        });\n        i0.ɵɵelement(25, \"ion-icon\", 11);\n        i0.ɵɵelementStart(26, \"ion-label\");\n        i0.ɵɵtext(27, \"Order\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(28, \"ion-tab-button\", 12);\n        i0.ɵɵlistener(\"click\", function TransaksiPage_Template_ion_tab_button_click_28_listener() {\n          return ctx.transaksi();\n        });\n        i0.ɵɵelement(29, \"ion-icon\", 13);\n        i0.ɵɵelementStart(30, \"ion-label\");\n        i0.ɵɵtext(31, \"Transaksi\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(32, \"ion-tab-button\", 14);\n        i0.ɵɵlistener(\"click\", function TransaksiPage_Template_ion_tab_button_click_32_listener() {\n          return ctx.profile();\n        });\n        i0.ɵɵelement(33, \"ion-icon\", 15);\n        i0.ɵɵelementStart(34, \"ion-label\");\n        i0.ɵɵtext(35, \"Profile\");\n        i0.ɵɵelementEnd()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(5);\n        i0.ɵɵtwoWayProperty(\"ngModel\", ctx.selectedSegment);\n        i0.ɵɵadvance(10);\n        i0.ɵɵproperty(\"ngIf\", ctx.selectedSegment === \"booking\");\n        i0.ɵɵadvance();\n        i0.ɵɵproperty(\"ngIf\", ctx.selectedSegment === \"proses\");\n        i0.ɵɵadvance();\n        i0.ɵɵproperty(\"ngIf\", ctx.selectedSegment === \"selesai\");\n      }\n    },\n    dependencies: [i5.NgForOf, i5.NgIf, i6.NgControlStatus, i6.NgModel, i4.IonButton, i4.IonCard, i4.IonCardContent, i4.IonContent, i4.IonHeader, i4.IonIcon, i4.IonLabel, i4.IonSegment, i4.IonSegmentButton, i4.IonTabBar, i4.IonTabButton, i4.IonTitle, i4.IonToolbar, i4.SelectValueAccessor],\n    styles: [\"ion-header[_ngcontent-%COMP%]{background:#0ff;text-align:center}ion-card[_ngcontent-%COMP%]{background-color:#6c71f7;align-items:center}.car-card[_ngcontent-%COMP%]{background-color:#6c71f7;color:#000}h1[_ngcontent-%COMP%]{font-weight:700}\"]\n  });\n  return TransaksiPage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}