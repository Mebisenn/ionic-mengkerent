"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[701],{701:(j,m,l)=>{l.r(m),l.d(m,{ProfilePageModule:()=>F});var f=l(177),p=l(4341),a=l(5150),h=l(8465),c=l(467),d=l(1626),e=l(4438),g=l(369);let b=(()=>{var o;class i{constructor(t){this.http=t,this.apiUrl="https://www.sipelantis.com/api/logout"}logout(){return this.http.post(`${this.apiUrl}`,{})}}return(o=i).\u0275fac=function(t){return new(t||o)(e.KVO(d.Qq))},o.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"}),i})(),k=(()=>{var o;class i{constructor(t,r){this.http=t,this.storage=r,this.apiUrl="https://www.sipelantis.com/api/terms"}getTerms(){var t=this;return(0,c.A)(function*(){const r=yield t.storage.get("auth-token"),n=new d.Lr({Authorization:`Bearer ${r}`});return t.http.get(t.apiUrl,{headers:n})})()}}return(o=i).\u0275fac=function(t){return new(t||o)(e.KVO(d.Qq),e.KVO(g.w))},o.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"}),i})();const v=[{path:"",component:(()=>{var o;class i{constructor(t,r,n,u,y,I){this.router=t,this.http=r,this.storage=n,this.authService=u,this.termsService=y,this.alertController=I,this.user=null,this.userId=null,this.terms=""}ngOnInit(){var t=this;return(0,c.A)(function*(){yield t.initStorage(),yield t.loadUserProfile(),yield t.loadTerms()})()}initStorage(){var t=this;return(0,c.A)(function*(){yield t.storage.create(),console.log("Storage initialized")})()}loadUserProfile(){var t=this;return(0,c.A)(function*(){const r=yield t.storage.get("auth-token");if(console.log("Retrieved token:",r),t.userId=yield t.storage.get("user-id"),console.log("Retrieved userId:",t.userId),!r)return void console.error("No authentication token found");if(!t.userId)return void console.error("No user ID found");const n=new d.Lr({Authorization:`Bearer ${r}`});t.http.get(`https://www.sipelantis.com/api/users/${t.userId}`,{headers:n}).subscribe(u=>{t.user=u.user,console.log("User profile loaded:",t.user)},u=>{console.error("Error loading user profile:",u)})})()}loadTerms(){var t=this;return(0,c.A)(function*(){try{(yield t.termsService.getTerms()).subscribe(n=>{t.terms=n.data.map(u=>u.syarat_ketentuan).join("<br><br>"),console.log("Terms loaded:",t.terms)},n=>{console.error("Error loading terms:",n)})}catch(r){console.error("Failed to load terms",r)}})()}goEdit(){this.router.navigate(["/edit-profile"])}LogOut(){var t=this;return(0,c.A)(function*(){try{const r=yield t.storage.get("auth-token");if(console.log("Token:",r),!r)return void console.error("No authentication token found");const n=new d.Lr({Authorization:`Bearer ${r}`});yield t.http.post("https://www.sipelantis.com/api/logout",{},{headers:n}).toPromise(),yield t.storage.remove("auth-token"),yield t.storage.remove("user-id"),yield(yield t.alertController.create({header:"Logout",message:"Anda telah logout",buttons:["OK"]})).present(),t.router.navigate(["/login"])}catch(r){console.error("Failed to logout",r)}})()}home(){this.router.navigate(["/home"])}order(){this.router.navigate(["/cars"])}transaksi(){this.router.navigate(["/transaksi"])}profile(){this.router.navigate(["/profile"])}}return(o=i).\u0275fac=function(t){return new(t||o)(e.rXU(h.Ix),e.rXU(d.Qq),e.rXU(g.w),e.rXU(b),e.rXU(k),e.rXU(a.hG))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-profile"]],decls:49,vars:4,consts:[[2,"background-color","#6c71f7"],["name","person-outline"],["name","people-outline"],["name","map-outline"],["name","briefcase-outline"],["expand","block",3,"click"],["href","https://wa.me/6285771242655?text=HI!%20"],["name","call-outline"],["color","danger","expand","block",3,"click"],["id","tabs"],["slot","bottom"],["id","home","tab","home",3,"click"],["name","home-outline"],["tab","radio",3,"click"],["name","car-outline"],["tab","transaksi",3,"click"],["name","cash-outline"],["tab","library",3,"click"]],template:function(t,r){1&t&&(e.j41(0,"ion-content")(1,"ion-card",0)(2,"ion-card-header")(3,"ion-card-title"),e.EFF(4,"Info Profile"),e.k0s()(),e.j41(5,"ion-card-content")(6,"ion-item")(7,"ion-label"),e.nrm(8,"ion-icon",1),e.EFF(9),e.k0s()(),e.j41(10,"ion-item")(11,"ion-label"),e.nrm(12,"ion-icon",2),e.EFF(13),e.k0s()(),e.j41(14,"ion-item")(15,"ion-label"),e.nrm(16,"ion-icon",3),e.EFF(17),e.k0s()(),e.j41(18,"ion-item")(19,"ion-label"),e.nrm(20,"ion-icon",4),e.EFF(21),e.k0s()(),e.j41(22,"ion-button",5),e.bIt("click",function(){return r.goEdit()}),e.EFF(23,"Edit Profile"),e.k0s()()(),e.j41(24,"ion-card",0)(25,"ion-card-header")(26,"ion-card-title"),e.EFF(27,"Lainnya"),e.k0s()(),e.j41(28,"ion-card-content")(29,"ion-item")(30,"a",6),e.nrm(31,"ion-icon",7),e.EFF(32," Hubungi Kami"),e.k0s()()()(),e.j41(33,"ion-button",8),e.bIt("click",function(){return r.LogOut()}),e.EFF(34,"Log Out"),e.k0s()(),e.j41(35,"div",9)(36,"ion-tab-bar",10)(37,"ion-tab-button",11),e.bIt("click",function(){return r.home()}),e.nrm(38,"ion-icon",12),e.EFF(39," Home "),e.k0s(),e.j41(40,"ion-tab-button",13),e.bIt("click",function(){return r.order()}),e.nrm(41,"ion-icon",14),e.EFF(42," Order "),e.k0s(),e.j41(43,"ion-tab-button",15),e.bIt("click",function(){return r.transaksi()}),e.nrm(44,"ion-icon",16),e.EFF(45," Transaksi "),e.k0s(),e.j41(46,"ion-tab-button",17),e.bIt("click",function(){return r.profile()}),e.nrm(47,"ion-icon",1),e.EFF(48," Profile "),e.k0s()()()),2&t&&(e.R7$(9),e.SpI(" ",null==r.user?null:r.user.name,""),e.R7$(4),e.SpI(" ",null==r.user?null:r.user.gender,""),e.R7$(4),e.SpI(" ",null==r.user?null:r.user.alamat,""),e.R7$(4),e.SpI(" ",null==r.user?null:r.user.pekerjaan,""))},dependencies:[a.Jm,a.b_,a.I9,a.ME,a.tN,a.W9,a.iq,a.uz,a.he,a.Jq,a.qW]}),i})()}];let P=(()=>{var o;class i{}return(o=i).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[h.iI.forChild(v),h.iI]}),i})(),F=(()=>{var o;class i{}return(o=i).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[f.MD,p.YN,a.bv,P]}),i})()}}]);